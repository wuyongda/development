<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="UTF-8">
		<title>tree-table</title>
		<link rel="stylesheet" href="../../plugin/layui/css/layui.css">
	</head>
	<body>
		<div class="layui-container">
			<br><br>
			<a class="layui-btn layui-btn-normal" href="index.html">&lt;&lt;返回</a>
			&nbsp;&nbsp;
			<div class="layui-btn-group">
				<button class="layui-btn" id="btn-expand">全部展开</button>
				<button class="layui-btn" id="btn-fold">全部折叠</button>
			</div>
			<script type="text/html" id="toolbarDemo">
				<div class="layui-btn-container">
					<button class="layui-btn layui-btn-sm" lay-event="add">新增</button>
					<button class="layui-btn layui-btn-sm" lay-event="update">修改</button>
					<button class="layui-btn layui-btn-sm" lay-event="delete">删除</button>
				</div>
			</script>
			<table id="auth-table" class="layui-table" lay-filter="auth-table"></table>
			<script type="text/html" id="test">

			</script>
		</div>
		<!-- 操作列 -->
		<script type="text/html" id="auth-opt">
			<a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="edit">修改</a>
			<a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
		</script>
		
		<script type="text/html" id="addForm">
			
		</script>
		<script src="../../plugin/jquery-3.3.1.min.js" type="text/javascript"></script>
		<script src="../../plugin/layui/layui.all.js"></script>
		<script>
			layui.config({
				base: '../../plugin/module/'
			}).extend({
				treetable: 'treetable-lay/treetable'
			}).use(['table', 'treetable'], function() {
				var $ = layui.jquery;
				var table = layui.table;
				var treetable = layui.treetable;

				// 渲染表格
				layer.load(2);
				treetable.render({
					treeColIndex: 1,
					treeSpid: 0,
					treeIdName: 'id',
					treePidName: 'parentId',
					elem: '#auth-table',
					toolbar: '#toolbarDemo',
					url: 'http://localhost:8080/sysMenu',
					page: false,
					cols: [[
						{type: 'numbers'},
						{field: 'name',minWidth: 200,title: '权限名称'},
						{field: 'authority',title: '权限标识'},
						{field: 'url',title: '菜单url'},
						{field: 'orderNumber',width: 80,align: 'center',title: '排序号'},
						{
							field: 'type',
							width: 80,
							align: 'center',
							templet: function(d) {
								if(d.isMenu == 2) {
									return '<span class="layui-badge layui-bg-gray">按钮</span>';
								}
								if(d.parentId == 0) {
									return '<span class="layui-badge layui-bg-blue">目录</span>';
								} else {
									return '<span class="layui-badge-rim">菜单</span>';
								}
							},
							title: '类型'
						},
						{templet: '#auth-opt',width: 120,align: 'center',title: '操作'}
					]],

					done: function() {
						layer.closeAll('loading');
					}
				});

				$('#btn-expand').click(function() {
					treetable.expandAll('#auth-table');
				});

				$('#btn-fold').click(function() {
					treetable.foldAll('#auth-table');
				});

				//监听事件
				table.on('toolbar', function(obj) {
					switch(obj.event) {
						case 'add':
							addMenu();
							break;
						case 'delete':
							layer.msg('删除');
							break;
						case 'update':
							layer.msg('编辑');
							break;
					};
				});
			});

			function addMenu() {
				layer.open({
					type: 2,
					area: ['500px', '450px'],
					content: "addForm.html" //这里content是一个DOM，注意：最好该元素要存放在body最外层，否则可能被其它的相对元素所影响
				});
			}
		</script>
	</body>

</html>